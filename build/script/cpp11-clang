#! /bin/sh
#
# $Id: //poco/1.4/build/script/cpp11-clang#1 $
#
# cpp11-clang
#
# Detect compatible Clang version and add c++11/14 flags
#

CLANG_MAJOR_VER_GTE_4 := $(shell expr `clang++ -dumpversion | cut -f1 -d.` \>= 4)
CLANG_MAJOR_VER_GTE_3 := $(shell expr `clang++ -dumpversion | cut -f1 -d.` \>= 3)
CLANG_MINOR_VER_GTE_3 := $(shell expr `clang++ -dumpversion | cut -f2 -d.` \>= 3)
CLANG_MINOR_VER_GTE_4 := $(shell expr `clang++ -dumpversion | cut -f2 -d.` \>= 4)

ifeq "$(CLANG_MAJOR_VER_GTE_4)" "1"
	CXXFLAGS += -std=c++1y
else ifeq "$(CLANG_MAJOR_VER_GTE_3)" "1"
	# C++14 needs clang 3.4
    ifeq "$(CLANG_MINOR_VER_GTE_4)" "1"
        CXXFLAGS += -std=c++1y
	# C++11 needs clang 3.3
    else ifeq "$(CLANG_MINOR_VER_GTE_3)" "1"
        CXXFLAGS += -std=c++11
    endif
endif

